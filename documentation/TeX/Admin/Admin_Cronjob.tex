\chapter{Cronjob}
\label{Cronjob}
\\
Um die Daten regelmäßig zu Prüfen und um Inkonsistenzen vorzubeugen, können im FH-Complete Zeitgesteuerte Scripte (Cronjobs) gestartet werden.
Cronjobs werden im FHComplete gesammelt verwaltet. Damit diese funktionieren, muss in der Crontab folgender Eintrag angelegt werden:\\
\\
*/5   *   * * *    /var/www/vilesci/htdocs/vilesci/cronjobs/cronjob.php > cron.log\\
\\
Dieser Eintrag muss auf jedem Server gemacht werden, auf dem ein Job laufen soll.\\
Die einzelnen Jobs können über die Vilesci-Seite unter Admin->Cronjobs verwaltet werden.
Zum Testen ob der Dienst funktioniert existiert ein Testjob. Dieser sendet automatisch ein Mail wenn der Job gestartet wird.
\\
\\
\textbf{Folgende Felder können zu Cronjobs eingetragen werden:}\\
- Titel: Titel des Jobs\\
- Beschreibung: Kurzbeschreibung zu dem Job\\
- Server: Server auf dem der Job ausgeführt werden soll (Crontab-Eintrag muss auf diesem Server vorhanden sein!)\\
- Datei: absoluter Pfad zu dem Cronjob. Beispiel für den Testjob: '/var/www/vilesci/htdocs/vilesci/cronjobs/testjob.php'\\
- Zeitangabe: der Ausführungszeitpunkt kann entweder direkt oder als Interval angegeben werden. (mit */<Zeitinterval) Die Funktionsweise ist mit jener 
der Unix Cronjobs vergleichbar.\\
Beispiele:
Job soll jeden 1. des Monats um 02:00 Uhr gestartet werden:\\
Das Feld Tag muss auf 1 gesetzt werden, Stunde auf 2 und Minute auf 00. Die anderen Felder bleiben leer.\\
Job soll jeden 2. Tag laufen:\\
Das Feld Tag wird auf */2 gesetzt. Alle anderen bleiben leer.\\
Der Job soll jeden Sonntag im Jahr 2010 um 01:00 Uhr laufen:\\
Jahr wird auf 2010 gesetzt, Wochentag auf Sonntag, Stunde auf 1 und Minute auf 00. Die restlichen Felder bleiben leer.\\
- Aktiv: inaktive Jobs werden nicht ausgeführt\\
- Standalone: Wenn dies gesetzt ist, dann darf der Job nur alleine ausgeführt werden. Wenn zur selben Zeit ein anderer Job läuft, dann wird dieser nicht ausgeführt.\\
- Reihenfolge: Bei Jobs die zur gleichen Zeit gestartet werden, werden die mit der niedrigeren Reihenfolge zuerst ausgeführt.\\
- Varialben: Hier können Variablen eingetragen werden, die an den Cronjob übergeben werden. Diese müssen im JSON-Format eingetragen werden. Zu unterstützung steht ein Variablen-Editor zur Verfügung.
Beim Anlegen eines neuen Jobs können die Variablen automatisch initialisiert werden. Dies ruft den Cronjob mit einem Initialisierungsparameter auf. Das Script setzt daraufhin die Standard-Variablen für diesen Job.
\\

